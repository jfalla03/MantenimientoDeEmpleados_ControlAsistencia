use master
go
SET LANGUAGE SPANISH
GO
IF EXISTS(SELECT * FROM SYSDATABASES WHERE NAME='EFFICAL')
BEGIN
	ALTER DATABASE EFFICAL
	SET SINGLE_USER WITH ROLLBACK IMMEDIATE
	DROP DATABASE EFFICAL
END
GO

create database EFFICAL

use EFFICAL
go

CREATE TABLE USUARIO
(
	Nombre CHAR(20) PRIMARY KEY NOT NULL,
	Correo CHAR(80) NOT NULL,
	Clave VARCHAR(8) NOT NULL,
	Roles VARCHAR(20) NOT NULL
)
GO
INSERT INTO USUARIO VALUES('admin','admin25@gmail.com','123456','Administrador')
INSERT INTO USUARIO VALUES('JUAN','jperez@GMAIL.com','78987455','Empleado')
INSERT INTO USUARIO VALUES('MARIA','mlopez@GMAIL.com','74127832','Empleado')
INSERT INTO USUARIO VALUES('ROSARIO','rosariorm7207@gmail.com','16766892','Empleado')
insert into USUARIO values('JULIO','jfallachiroque@gmail.com','70511855','Empleado')
insert into USUARIO values('FERNANDO','nizamavierafernandojose@gmail.com','61208035','Empleado')
insert into USUARIO values('YOSELIN','yoselinadiavr@gmail.com','76077535','Empleado')
insert into USUARIO values('FRANK','frank.perezc24@gmail.com','73586482','Empleado')
insert into USUARIO values('WILSON','wilsonromeroruiz@gmail.com','75783463','Empleado')
go

CREATE TABLE RecuperarContraseñas 
(
	NOMBREUSUARIO CHAR(20) PRIMARY KEY NOT NULL,
    Token VARCHAR(100) NOT NULL,
    Expiracion DATETIME NOT NULL
    FOREIGN KEY (NOMBREUSUARIO) REFERENCES USUARIO(Nombre)
)


CREATE TABLE EMPLEADO
(
    COD_EMPLEADO CHAR(5) NOT NULL PRIMARY KEY,
    NOM_EMPLEADO VARCHAR(45) NOT NULL,
    APE_EMPLEADO VARCHAR(45) NOT NULL,
    DNI_EMPLEADO CHAR(8) NOT NULL,
    DIREC_MPLEADO VARCHAR(45) NOT NULL,
    TELE_EMPLEADO CHAR(9) NOT NULL,
    EMAIL_EMPLEADO VARCHAR(60) NOT NULL,
    NombreUsuario CHAR(20) REFERENCES USUARIO(Nombre) 
);
INSERT INTO EMPLEADO VALUES('E1000','JUAN','PEREZ','78987455','CALLE LIMA','978482478','JPEREZ@GMAIL.COM','JUAN')
INSERT INTO EMPLEADO VALUES('E1001','MARIA','LOPEZ','74127832','AV CALLAO','987455170','MLOPEZ@GMAIL.COM', 'MARIA')
INSERT INTO EMPLEADO VALUES('E1002','ROSARIO','RODRIGUEZ','16766892','AV LAS AMERICAS','910020038','rosariorm7207@gmail.com', 'ROSARIO')
INSERT INTO EMPLEADO VALUES('E1003','JULIO','FALLA','70511855','CALLE LOS NARANJOS','940836180','jfallachiroque@gmail.com','JULIO')
INSERT INTO EMPLEADO VALUES('E1004','FERNANDO','NIZAMA','61208035','AVENIDA PARDO','987123456','nizamavierafernandojose@gmail.com', 'FERNANDO')
INSERT INTO EMPLEADO VALUES('E1005','YOSELIN','VARGAS','76077535','CALLE JUNIN','910203040','yoselinadiavr@gmail.com', 'YOSELIN')
INSERT INTO EMPLEADO VALUES('E1006','FRANK','PEREZ','73586482','AVENIDA HUANCAYO','987654321','frank.perezc24@gmail.com', 'FRANK')
INSERT INTO EMPLEADO VALUES('E1007','WILSON','ROMERO','75783463','CALLE AYACUCHO','919293949','wilsonromeroruiz@gmail.com', 'WILSON')
go


CREATE TABLE CONTROL_DE_ASISTENCIA
(
	COD_ASISTENCIA CHAR(8) NOT NULL PRIMARY KEY,
	FECH_ASISTENCIA DATE NOT NULL,
	HORA_ENTRADA TIME,
	HORA_DESCANSO_INICIO TIME,
    HORA_DESCANSO_FIN TIME,
	HORA_SALIDA TIME,	
	ESTADO_ASISTENCIA VARCHAR(20),
	COD_EMPLEADO CHAR(5) NOT NULL REFERENCES EMPLEADO,
)
GO

INSERT INTO CONTROL_DE_ASISTENCIA VALUES('AS1000', '2023-06-29', '07:50:08', '12:01:05', '12:59:21', '17:00:29', 'LABORANDO', 'E1000')
INSERT INTO CONTROL_DE_ASISTENCIA VALUES('AS1001', '2023-06-29', '08:00:38', '12:00:07', '12:54:42', '17:10:49', 'LABORANDO', 'E1001')
INSERT INTO CONTROL_DE_ASISTENCIA VALUES('AS1002', '2023-06-29', '08:10:18', '12:05:18', '12:57:05', '16:58:15', 'LABORANDO', 'E1002')
INSERT INTO CONTROL_DE_ASISTENCIA VALUES('AS1003', '2023-06-29', '08:10:18', '12:05:18', '12:57:05', '16:58:15', 'LABORANDO', 'E1003')
INSERT INTO CONTROL_DE_ASISTENCIA VALUES('AS1004', '2023-06-29', '08:10:18', '12:05:18', '12:57:05', '16:58:15', 'LABORANDO', 'E1004')
INSERT INTO CONTROL_DE_ASISTENCIA VALUES('AS1005', '2023-06-29', '08:10:18', '12:05:18', '12:57:05', '16:58:15', 'LABORANDO', 'E1005')
INSERT INTO CONTROL_DE_ASISTENCIA VALUES('AS1006', '2023-06-29', '08:10:18', '12:05:18', '12:57:05', '16:58:15', 'LABORANDO', 'E1006')
INSERT INTO CONTROL_DE_ASISTENCIA VALUES('AS1007', '2023-06-29', '08:10:18', '12:05:18', '12:57:05', '16:58:15', 'LABORANDO', 'E1007')

go



CREATE TABLE SolicitudesJustificacion
(
    CodSolicitud int identity NOT NULL PRIMARY KEY,
    CodEmpleado CHAR(5) NOT NULL REFERENCES Empleado(COD_EMPLEADO),
    Motivo NVARCHAR(500) NOT NULL,
    FechaSolicitud DATETIME NOT NULL,
    Estado NVARCHAR(20) NOT NULL,
    RutaImagen NVARCHAR(MAX) 
);

CREATE TABLE SueldoEmpleados
(
    Id char(8) NOT NULL  PRIMARY KEY ,
    CodEmpleado CHAR(5) NOT NULL REFERENCES Empleado(COD_EMPLEADO),
    Monto DECIMAL(10, 2) NOT NULL,
    Periodo VARCHAR(50) NOT NULL,
    FechaPago VARCHAR(50) NOT NULL,
    Impuestos DECIMAL(10, 2) NOT NULL,
    Comentarios NVARCHAR(255)
);
INSERT INTO SueldoEmpleados (Id, CodEmpleado, Monto, Periodo, FechaPago, Impuestos, Comentarios)
VALUES
    ('SE1000', 'E1000', 1025.00, '2023-08-01', '2023-08-10', 15.00, 'Sueldo de agosto para empleado Juan Perez.'),
    ('SE1001', 'E1001', 1025.00, '2023-08-01', '2023-08-10', 15.00, 'Sueldo de agosto para empleado Maria Lopez.'),
    ('SE1002', 'E1002', 1025.00, '2023-08-01', '2023-08-10', 15.00, 'Sueldo de agosto para empleado Rosario Rodriguez.'),
    ('SE1003', 'E1003', 1025.00, '2023-08-01', '2023-08-10', 15.00, 'Sueldo de agosto para empleado Julio Falla.'),
    ('SE1004', 'E1004', 1025.00, '2023-08-01', '2023-08-10', 15.00, 'Sueldo de agosto para empleado Fernando Nizama.'),
    ('SE1005', 'E1005', 1025.00, '2023-08-01', '2023-08-10', 15.00, 'Sueldo de agosto para empleado Yoselin Vargas.'),
    ('SE1006', 'E1006', 1025.00, '2023-08-01', '2023-08-10', 15.00, 'Sueldo de agosto para empleado Frank Perez.'),
    ('SE1007', 'E1007', 1025.00, '2023-08-01', '2023-08-10', 15.00, 'Sueldo de agosto para empleado Wilson Romero.');

